(function(t){function e(e){for(var n,a,o=e[0],c=e[1],l=e[2],u=0,d=[];u<o.length;u++)a=o[u],r[a]&&d.push(r[a][0]),r[a]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);h&&h(e);while(d.length)d.shift()();return s.push.apply(s,l||[]),i()}function i(){for(var t,e=0;e<s.length;e++){for(var i=s[e],n=!0,o=1;o<i.length;o++){var c=i[o];0!==r[c]&&(n=!1)}n&&(s.splice(e--,1),t=a(a.s=i[0]))}return t}var n={},r={app:0},s=[];function a(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=t,a.c=n,a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)a.d(i,n,function(e){return t[e]}.bind(null,n));return i},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/shinny-futures-web/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var h=c;s.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"0894":function(t,e,i){"use strict";var n=i("2262"),r=i.n(n);r.a},"11b0":function(t,e,i){"use strict";var n=i("6ee0"),r=i.n(n);r.a},"12fe":function(t,e,i){"use strict";var n=i("cf60"),r=i.n(n);r.a},2262:function(t,e,i){},2770:function(t,e,i){},"2ad8":function(t,e,i){},4262:function(t,e,i){"use strict";var n=i("2ad8"),r=i.n(n);r.a},"491c":function(t,e,i){},"55b5":function(t,e,i){"use strict";var n=i("2770"),r=i.n(n);r.a},"56d7":function(t,e,i){"use strict";i.r(e);i("fca0"),i("c5f6"),i("cadf"),i("551c"),i("097d");var n=i("2b0e"),r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Layout",{attrs:{id:"shinny-app"}},[i("Sider",{staticClass:"sider",attrs:{width:"42"}},[t.isShowBackBtn?i("Tooltip",{attrs:{content:"返回",placement:"right"}},[i("Button",{attrs:{type:"text",size:"small"},on:{click:function(e){t.$router.go(-1)}}},[i("Icon",{attrs:{type:"md-return-left",size:"24"}})],1)],1):t._e(),i("Tooltip",{attrs:{content:"设置",placement:"right"}},[i("Button",{attrs:{type:"text",size:"small"},on:{click:function(e){t.isShowSettingModel=!0}}},[i("Icon",{attrs:{type:"md-settings",size:"24"}})],1),i("Modal",{attrs:{title:"设置",scrollable:!0},on:{"on-ok":t.onClickOk,"on-cancel":t.onClickCancel,"on-visible-change":t.onVisibleChange},model:{value:t.isShowSettingModel,callback:function(e){t.isShowSettingModel=e},expression:"isShowSettingModel"}})],1),i("Tooltip",{attrs:{content:"打开天勤主页",placement:"right"}},[i("Button",{attrs:{type:"text",size:"small",to:"https://www.shinnytech.com/tianqin/",target:"_blank"}},[i("Icon",{attrs:{type:"md-home",size:"24"}})],1)],1)],1),i("Content",{staticClass:"content"},[i("Split",{attrs:{mode:"vertical"},model:{value:t.$root.appSplit,callback:function(e){t.$set(t.$root,"appSplit",e)},expression:"$root.appSplit"}},[i("div",{staticClass:"split-pane",attrs:{slot:"top"},slot:"top"},[i("keep-alive",[i("router-view",{attrs:{name:"quotes"}})],1)],1),i("div",{staticClass:"split-horizontal",attrs:{slot:"trigger"},slot:"trigger"},[i("div",{staticClass:"split-horizontal-dots"},[i("span",{staticClass:"dot"}),i("span",{staticClass:"dot"}),i("span",{staticClass:"dot"}),i("span",{staticClass:"dot"}),i("span",{staticClass:"dot"})])]),i("div",{staticClass:"split-pane",attrs:{slot:"bottom"},slot:"bottom"},[i("router-view",{attrs:{name:"user"}})],1)])],1)],1)},s=[],a=(i("7f7f"),{data:function(){return{isShowSettingModel:!1}},methods:{showSettingModel:function(){},onClickOk:function(){console.log("onClickOk")},onClickCancel:function(){console.log("onClickCancel")},onVisibleChange:function(t){console.log(t)}},computed:{isShowBackBtn:function(){return"charts"===this.$route.name}},beforeCreate:function(){},created:function(){},beforeMount:function(){},mounted:function(){this.$on("tqsdk:notify",function(t){"INFO"===t.level?"SETTLEMENT"===t.type?this.$store.commit("SET_SETTLEMENT",t):"MESSAGE"===t.type&&this.$Message.info(t.content):"WARNING"!==t.level&&"ERROR"!==t.level||this.$Message.error(t.content)})},beforeUpdate:function(){},updated:function(){},activated:function(){},deactivated:function(){},beforeDestroy:function(){},destroyed:function(){},errorCaptured:function(t,e,i){return console.error("App.errorCaptured",t,e,i),!1}}),o=a,c=(i("5c0b"),i("2877")),l=Object(c["a"])(o,r,s,!1,null,null,null);l.options.__file="App.vue";var h=l.exports,u=i("8c4f"),d=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"quotes-container",staticStyle:{height:"100%"}},[i("SplitLeftRight",{attrs:{split:.8}},[i("template",{slot:"left"},[i("div",{staticClass:"top-content"},[i("ButtonsLine",{attrs:{tags:t.tags,defaultTag:t.defaultTag},on:{change:t.handlerChangeTag}})],1),i("div",{staticClass:"bottom-content",staticStyle:{top:"28px"}},[i("table-quotes",{attrs:{contentList:t.quotesList,tableCol:t.quotesTableRow,rootPath:t.rootPath}})],1)]),i("template",{slot:"right"},[i("div",{staticClass:"top-content"},[i("quote-info",{attrs:{instrumentId:t.instrumentId}})],1),i("div",{staticClass:"bottom-content",staticStyle:{top:"220px"}},[i("ticks-list",{attrs:{instrumentId:t.instrumentId}})],1)])],2)],1)},f=[],p=(i("a481"),i("be94")),m=i("2f62"),_=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tq-table-container",style:{height:"100%"},on:{scroll:t.handleScroll}},[i("table",{attrs:{id:"QuotesTable"}},[i("thead",[i("tr",t._l(t.tableCol,function(e){return i("td",[i("div",{style:t.computeStyleObj(e)},[t._v(t._s(e["name"]))])])}),0)]),i("tbody",t._l(t.contentList,function(e,n){return i("table-row",{key:e,class:{selected:e===t.selectedSymbol},attrs:{symbol:e,path:t.rootPath+e+"/",tableCol:t.tableCol},on:{rowClick:t.rowClick,rowDbClick:t.rowDbClick}})}),1)])])},g=[],v=(i("6762"),i("2fdb"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("tr",{on:{click:t.handlerClick,dblclick:t.handlerDbClick}},[i("td",[i("div",[t._v(t._s(t.ins_name))]),i("div",{staticClass:"appendix"},[t._v(t._s(t.ins_id))])]),t._l(t.tableCol,function(e,n){return n>0?i("td",{key:n,class:t.classNameStr(e)},[i("div",{staticClass:"data-content",style:t.styleObj(e),attrs:{"data-content":t.formatter(e)}})]):t._e()})],2)}),b=[],y={data:function(){return{priceDecs:0,priceTick:1,ins_id:"",ins_name:"",quote:{}}},components:{},props:{tableCol:{type:Array},symbol:{type:String},path:{type:String}},beforeMount:function(){this.quote=this.$tqsdk.get_quote(this.symbol),this.priceDecs=this.quote.price_decs,this.priceTick=this.quote.price_tick,this.ins_name=this.quote.ins_name,"FUTURE_CONT"===this.quote.class?this.ins_id=this.quote.underlying_symbol:"FUTURE_INDEX"===this.quote.class?this.ins_id=this.quote.underlying_product:this.ins_id=this.quote.instrument_id},mounted:function(){this.$on("tqsdk:rtn_data",function(){this.$tqsdk.is_changed(this.quote)&&this.$forceUpdate()})},methods:{classNameStr:function(t){return"function"===typeof t["className"]?this.quote?t["className"](this.quote):"":t["className"]},styleObj:function(t){var e={};return t["width"]&&(e["width"]=t["width"]+"px"),e},formatter:function(t){return t.formatter?t.formatter(this.quote):this.quote[t.prop]},handlerClick:function(){this.$emit("rowClick",this.quote)},handlerDbClick:function(){this.$emit("rowDbClick",this.quote)},handlerRowContextmenu:function(t){t.stopPropagation(),t.preventDefault(),this.$emit("rowContextmenu",this.quote)}}},w=y,k=Object(c["a"])(w,v,b,!1,null,null,null);k.options.__file="TableQuotesRow.vue";var C=k.exports,S={data:function(){return{selectedSymbol:""}},components:{TableRow:C},props:{height:{type:String},tableCol:{type:Array},contentList:{type:Array},rootPath:{type:String}},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},mounted:function(){},beforeDestroy:function(){},computed:{},methods:{handleScroll:function(t){},computeStyleObj:function(t){var e={};return t["width"]&&(e["width"]=t["width"]+"px"),e},rowClick:function(t){this.$store.commit("SET_SELECTED_SHOW_SYMBOL",t.instrument_id),"FUTURE"===t.class?this.$store.commit("SET_SELECTED_SYMBOL",t.instrument_id):"FUTURE_CONT"===t.class&&this.$store.commit("SET_SELECTED_SYMBOL",t.underlying_symbol),this.selectedSymbol=t.instrument_id},rowDbClick:function(t){this.$router.push({name:"charts",params:{instrument_id:t.instrument_id}})},cellStyle:function(t){var e=t.row,i=t.column;t.rowIndex,t.columnIndex;return["最新价","涨跌","涨跌幅","今开盘","最高价","最低价"].includes(i.label)&&e.change%1===0&&0!==e.change?{color:e.change>0?"red":"green"}:{color:"black"}}}},E=S,x=(i("ab6f"),Object(c["a"])(E,_,g,!1,null,null,null));x.options.__file="Table.vue";var O=x.exports,T=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.quote?i("div",{staticClass:"quoteinfo-container"},[i("Row",[i("Col",{attrs:{span:"12"}},[i("div",[t._v(t._s(t.quote.ins_name))])]),i("Col",{attrs:{span:"12"}},[i("div",[t._v(t._s(t.instrumentId))])])],1),i("div",{staticClass:"contrast"},[i("Row",[i("Col",{attrs:{span:"6"}},[i("div",[t._v("卖一")])]),i("Col",{attrs:{span:"6"}},[i("div",[t._v(t._s(t.formatter(t.quote.ask_price1)))])]),i("Col",{attrs:{span:"6"}},[t._v("\n            "+t._s(t.quote.ask_volume1)+"\n            ")]),i("Col",{attrs:{span:"6"}})],1),i("div",{staticClass:"outer"},[i("div",{staticClass:"inner",style:{width:100*t.innerWidth+"%"}})]),i("Row",[i("Col",{attrs:{span:"6"}},[t._v("\n            买一")]),i("Col",{attrs:{span:"6"}},[t._v("\n            "+t._s(t.formatter(t.quote.bid_price1)))]),i("Col",{attrs:{span:"6"}},[t._v("\n            "+t._s(t.quote.bid_volume1))]),i("Col",{attrs:{span:"6"}})],1)],1),i("Row",[i("Col",{attrs:{span:"6"}},[t._v("\n        最新价")]),i("Col",{class:t.classOfColor,attrs:{span:"6"}},[t._v("\n        "+t._s(t.formatter(t.quote.last_price)))]),i("Col",{attrs:{span:"6"}},[t._v("\n        昨结算")]),i("Col",{attrs:{span:"6"}},[t._v("\n        "+t._s(t.formatter(t.quote.pre_settlement)))])],1),i("Row",[i("Col",{attrs:{span:"6"}},[t._v("\n        涨跌")]),i("Col",{class:t.classOfColor,attrs:{span:"6"}},[t._v("\n        "+t._s(t.formatter(t.quote.change)))]),i("Col",{attrs:{span:"6"}},[t._v("\n        今开")]),i("Col",{attrs:{span:"6"}},[t._v("\n        "+t._s(t.quote.open))])],1),i("Row",[i("Col",{attrs:{span:"6"}},[t._v("\n        涨跌幅")]),i("Col",{class:t.classOfColor,attrs:{span:"6"}},[t._v("\n        "+t._s(t._f("toPercent")(t.quote.change_percent))+"%")]),i("Col",{attrs:{span:"6"}},[t._v("\n        最高")]),i("Col",{attrs:{span:"6"}},[t._v("\n        "+t._s(t.formatter(t.quote.highest)))])],1),i("Row",[i("Col",{attrs:{span:"6"}},[t._v("\n        总手")]),i("Col",{class:t.classOfColor,attrs:{span:"6"}},[t._v("\n        "+t._s(t.quote.volume))]),i("Col",{attrs:{span:"6"}},[t._v("\n        最低")]),i("Col",{attrs:{span:"6"}},[t._v("\n        "+t._s(t.formatter(t.quote.lowest)))])],1),i("Row",[i("Col",{attrs:{span:"6"}},[t._v("\n        涨停")]),i("Col",{staticClass:"R",attrs:{span:"6"}},[t._v("\n        "+t._s(t.formatter(t.quote.upper_limit)))]),i("Col",{attrs:{span:"6"}},[t._v("\n        收盘")]),i("Col",{attrs:{span:"6"}},[t._v("\n        "+t._s(t.formatter(t.quote.close)))])],1),i("Row",[i("Col",{attrs:{span:"6"}},[t._v("\n        跌停")]),i("Col",{staticClass:"G",attrs:{span:"6"}},[t._v("\n        "+t._s(t.formatter(t.quote.lower_limit)))]),i("Col",{attrs:{span:"6"}},[t._v("\n        结算")]),i("Col",{attrs:{span:"6"}},[t._v("\n        "+t._s(t.formatter(t.quote.settlement)))])],1),i("Row",[i("Col",{attrs:{span:"6"}},[t._v("\n        持仓量")]),i("Col",{attrs:{span:"6"}},[t._v("\n        "+t._s(t.quote.open_interest))]),i("Col",{attrs:{span:"6"}},[t._v("\n        日增")]),i("Col",{attrs:{span:"6"}},[t._v("\n        "+t._s(t.quote.open_interest-t.quote.pre_open_interest))])],1)],1):t._e()},D=[],j=i("53ca");i("f576"),i("28a5");function q(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return"number"===typeof t?t.toFixed(e):t}function I(t){var e=null;if("number"===typeof t){e=t>1e12&&t<3e12?new Date(t):new Date(t/1e6);var i=e.getFullYear()+"",n=(e.getMonth()+1+"").padStart(2,"0"),r=(e.getDate()+"").padStart(2,"0"),s=(e.getHours()+"").padStart(2,"0"),a=(e.getMinutes()+"").padStart(2,"0"),o=(e.getSeconds()+"").padStart(2,"0"),c=(e.getMilliseconds()+"").padStart(3,"0");return i+"/"+n+"/"+r+"-"+s+":"+a+":"+o+"."+c}return e}function P(t){switch(t){case"BUY":return"买";case"SELL":return"卖";default:return t}}function $(t){switch(t){case"OPEN":return"开";case"CLOSE":return"平昨";case"CLOSETODAY":return"平今";default:return t}}function M(t,e,i,n){if("object"===Object(j["a"])(t)&&Array.isArray(e)){for(var r=[],s=0;s<e.length;s++){var a=e[s],o="string"===typeof i?i:i(a),c=e[s][o];t.hasOwnProperty(c)&&n(a)?(e[s]=t[c],r.push(c)):e.splice(s--,1)}for(var l in t)if(!r.includes(l)){var h=t[l];n(h)&&e.push(h)}}}var N={data:function(){return{quote:this.$tqsdk.get_quote(this.instrumentId)}},mounted:function(){this.$on("tqsdk:rtn_data",this.update)},watch:{instrumentId:{handler:function(t,e){this.quote=this.$tqsdk.get_quote(t)},immediate:!0}},props:{instrumentId:String},computed:{classOfColor:function(){return this.quote["change"]>0?"R":this.quote["change"]<0?"G":""},innerWidth:function(){return this.quote.bid_volume1/(this.quote.bid_volume1+this.quote.ask_volume1)}},methods:{formatter:function(t){return q(t,this.quote.price_decs)},update:function(){this.quote=this.$tqsdk.get_quote(this.instrumentId),this.$forceUpdate()}}},A=N,R=(i("b947"),Object(c["a"])(A,T,D,!1,null,"5376659c",null));R.options.__file="QuoteInfo.vue";var L=R.exports,F=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tickslist-container",style:{height:t.height}},[i("table",[t._m(0),t.quote?i("tbody",t._l(t.ticks,function(e,n){return i("tr",{key:n},[i("td",[t._v(t._s(e.dt))]),i("td",{class:e.textColor},[t._v(t._s(e.price))]),i("td",{class:e.textColor},[t._v(t._s(e.vol))]),i("td",[t._v(t._s(e.oi))]),i("td",{class:e.textColor},[t._v(t._s(e.msg))])])}),0):t._e()])])},H=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("thead",[i("tr",[i("td",[t._v("时间")]),i("td",[t._v("价位")]),i("td",[t._v("现手")]),i("td",[t._v("增仓")]),i("td",[t._v("开平")])])])}],W={data:function(){return{ticks:[],quote:this.$tqsdk.get_quote(this.instrument_id)}},mounted:function(){this.$on("tqsdk:rtn_data",function(){var t=this.$tqsdk.dm.getTicks(this.instrumentId);t.last_id>0&&this.update()})},watch:{instrumentId:{handler:function(t,e){this.$tqsdk.set_chart({chart_id:"ticks_chart",symbol:t,duration:0}),this.quote=this.$tqsdk.get_quote(t),this.ticks.splice(0)},immediate:!0}},props:{instrumentId:String,height:String},methods:{genOneTick:function(t,e){var i=e[t],n=e[t-1];if(this.quote&&i&&n&&i.volume-n.volume>0){var r=i.volume-n.volume,s=i.open_interest-n.open_interest,a={datetime:i.datetime,dt:I(i.datetime).slice(11,19),price:q(i.last_price,this.quote.price_decs),vol:r,oi:s,msg:"",textColor:""},o=i.last_price-n.last_price,c=0;switch(c=i.last_price>=n.ask_price1?1:i.last_price<=n.bid_price1?-1:o>0?1:o<0?-1:0,a.msg=s>0&&s===r?"双开":s<0&&s+r===0?"双平":0===c?"换手":(c>0?"多":"空")+(s>0?"开":s<0?"平":"换"),a.msg){case"双开":case"双平":a.textColor=1===c?"R":-1===c?"G":"";break;case"多开":case"多换":case"空平":a.textColor="R";break;case"空开":case"空换":case"多平":a.textColor="G";break;default:a.textColor="";break}return a}return null},update:function(){var t=this.$tqsdk.dm.getTicks(this.instrumentId),e=50,i=0;if(0===this.ticks.length){this.last_id=t.last_id;for(var n=t.last_id;n>=0;n--){var r=this.genOneTick(n,t);if(null!==r&&(this.$set(this.ticks,i,r),i++,i===e))break}}else if(this.last_id<t.last_id){var s=this.genOneTick(t.last_id,t);null!==s&&s.datetime>this.ticks[0].datetime&&this.ticks.splice(0,0,s)}}}},B=W,G=(i("88cf"),Object(c["a"])(B,F,H,!1,null,"05053bc7",null));G.options.__file="TicksList.vue";var U=G.exports,z=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Split",{staticClass:"split-container",model:{value:t.this_split,callback:function(e){t.this_split=e},expression:"this_split"}},[i("div",{staticClass:"split-pane left",attrs:{slot:"left"},slot:"left"},[t._t("left")],2),i("div",{staticClass:"split-vertical",attrs:{slot:"trigger"},slot:"trigger"},[i("div",{staticClass:"split-vertical-dots"},[i("span",{staticClass:"dot"}),i("span",{staticClass:"dot"}),i("span",{staticClass:"dot"}),i("span",{staticClass:"dot"}),i("span",{staticClass:"dot"})])]),i("div",{staticClass:"split-pane right",attrs:{slot:"right"},slot:"right"},[t._t("right")],2)])},Y=[],Z={data:function(){return{this_split:.5}},created:function(){this.this_split=this.split},props:{split:{type:Number}}},Q=Z,X=(i("966f"),Object(c["a"])(Q,z,Y,!1,null,null,null));X.options.__file="SplitLeftRight.vue";var J=X.exports,K=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"row"},[i("div",t._l(t.tags,function(e,n){return i("div",{key:n,staticClass:"col"},[i("Button",{attrs:{size:"small",type:t.type(e)},on:{click:function(i){t.handlerClickTag(e)}}},[t._v("\n                "+t._s(e)+"\n            ")])],1)}),0)])},V=[],tt={name:"ButtonsLine",data:function(){return{selectedTag:this.defaultTag?this.defaultTag:this.tags[0]}},props:{tags:{type:Array,required:!0,validator:function(t){return t.length>0}},defaultTag:String},methods:{type:function(t){return t===this.selectedTag?"primary":"default"},handlerClickTag:function(t){this.selectedTag=t,this.$emit("change",t)}}},et=tt,it=(i("0894"),Object(c["a"])(et,K,V,!1,null,"8c7ab0d4",null));it.options.__file="ButtonsLine.vue";var nt=it.exports,rt={bid:"快期模拟"};var st=[{name:"合约代码",prop:"instrument_id",width:80},{name:"最新价",prop:"last_price",width:60,className:function(t){return t["change"]>0?"R":t["change"]<0?"G":""},formatter:function(t){return q(t["last_price"],t["price_decs"])}},{name:"时间",prop:"datetime",width:60,formatter:function(t){return t["datetime"]?t["datetime"].slice(11,19):""}},{name:"买价",prop:"bid_price1",width:60,className:"col-buy",formatter:function(t){return q(t["bid_price1"],t["price_decs"])}},{name:"买量",prop:"bid_volume1",width:60,className:"col-buy"},{name:"卖价",prop:"ask_price1",width:60,className:"col-sell",formatter:function(t){return q(t["ask_price1"],t["price_decs"])}},{name:"卖量",prop:"ask_volume1",width:60,className:"col-sell"},{name:"涨跌",prop:"change",width:60,className:function(t){return t["change"]>0?"R":t["change"]<0?"G":""},formatter:function(t){return q(t["change"],t["price_decs"])}},{name:"涨跌幅",prop:"change_percent",width:60,className:function(t){return t["change"]>0?"R":t["change"]<0?"G":""},formatter:function(t){var e=q(t["change"]/t["pre_settlement"]*100,2);return isNaN(e)?"-":e+"%"}},{name:"成交量",prop:"volume",width:60,className:function(t){return t["change"]>0?"R":t["change"]<0?"G":""}},{name:"今开盘",prop:"open",width:60,formatter:function(t){return q(t["open"],t["price_decs"])}},{name:"收盘",prop:"close",width:60,formatter:function(t){return q(t["close"],t["price_decs"])}},{name:"涨停",prop:"upper_limit",width:60,formatter:function(t){return q(t["upper_limit"],t["price_decs"])}},{name:"跌停",prop:"lower_limit",width:60,formatter:function(t){return q(t["lower_limit"],t["price_decs"])}},{name:"最高价",prop:"highest",width:60,formatter:function(t){return q(t["highest"],t["price_decs"])}},{name:"最低价",prop:"lowest",width:60,formatter:function(t){return q(t["lowest"],t["price_decs"])}},{name:"持仓量",prop:"open_interest",width:60},{name:"昨持",prop:"pre_open_interest",width:60},{name:"昨成交",prop:"pre_volume",width:60},{name:"昨收",prop:"pre_close",width:60,formatter:function(t){return q(t["pre_close"],t["price_decs"])}},{name:"昨结算",prop:"pre_settlement",width:60,formatter:function(t){return q(t["pre_settlement"],t["price_decs"])}}],at={name:"quotes",components:{TableQuotes:O,QuoteInfo:L,TicksList:U,SplitLeftRight:J,ButtonsLine:nt},data:function(){var t=this.$route.params.tag;return{defaultTag:t,tags:this.$store.state.tags,quotesTableRow:st,rootPath:"quotes/",selectedTab:"quoteInfo"}},computed:Object(p["a"])({quotesList:function(){var t=this.$store.state.tagsQuotesMap[this.$route.params.tag];return t&&this.$tqsdk.subscribe_quote(t),t},rowWidth:function(){var t=this.$store.state.tags.join("").length,e=this.$store.state.tags.length;return 12.5*t+20*e}},Object(m["b"])({instrumentId:"getSelectedShowInstrumentId"})),methods:{handlerChangeTag:function(t){this.$router.replace({name:"quotes",params:{tag:t}})}}},ot=at,ct=(i("733b"),Object(c["a"])(ot,d,f,!1,null,"104b0b1e",null));ct.options.__file="Quotes.vue";var lt=ct.exports,ht=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{height:"100%"}},[i("confirm"),t.$store.state.logined?i("trade"):i("login")],1)},ut=[],dt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"user-trade"},[i("SplitLeftRight",{attrs:{split:t.split}},[i("template",{slot:"left"},[i("Form",{attrs:{"label-width":60}},[i("FormItem",{attrs:{label:"合约"}},[i("AutoComplete",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入合约"},on:{"on-search":t.querySearch},model:{value:t.instrumentId,callback:function(e){t.instrumentId=e},expression:"instrumentId"}},[i("div",{staticClass:"auto-complete-search-result"},t._l(t.searchResult,function(e){return i("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])}),1)])],1),i("FormItem",{attrs:{label:"手数"}},[i("InputNumber",{staticStyle:{width:"200px"},attrs:{min:1},model:{value:t.volume,callback:function(e){t.volume=e},expression:"volume"}})],1),i("FormItem",{attrs:{label:"价格"}},[i("InputNumber",{staticStyle:{width:"200px"},attrs:{max:t.maxPrice,min:t.minPrice,step:t.priceTick},model:{value:t.limitPrice,callback:function(e){t.limitPrice=e},expression:"limitPrice"}})],1),i("FormItem",[i("Button",{on:{click:function(e){t.insertOrder("BUY","OPEN")}}},[t._v("买开")]),i("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){t.insertOrder("SELL","OPEN")}}},[t._v("卖开")])],1),i("FormItem",[i("Button",{on:{click:function(e){t.insertOrder("BUY","CLOSE")}}},[t._v("买平")]),i("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){t.insertOrder("SELL","CLOSE")}}},[t._v("卖平")])],1)],1)],1),i("template",{slot:"right"},[i("Tabs",{attrs:{type:"card",animated:!1},model:{value:t.selectedTab,callback:function(e){t.selectedTab=e},expression:"selectedTab"}},[i("TabPane",{attrs:{label:"账户",name:"accounts"}},[i("table-accounts")],1),i("TabPane",{attrs:{label:"持仓",name:"positions"}},[i("table-positions",{attrs:{height:t.height}})],1),i("TabPane",{attrs:{label:"委托单",name:"orders"}},[i("table-orders",{attrs:{height:t.height}})],1),i("TabPane",{attrs:{label:"成交记录",name:"trades"}},[i("table-trades",{attrs:{height:t.height}})],1)],1)],1)],2)],1)},ft=[],pt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"accounts-container"},[i("Table",{attrs:{columns:t.columns1,data:[t.account]}}),i("Table",{attrs:{columns:t.columns2,data:[t.account]}})],1)},mt=[],_t={data:function(){var t={balance:"账户权益",available:"可用资金",pre_balance:"账户权益",deposit:"入金金额",withdraw:"出金金额",commission:"手续费",premium:"权利金",static_balance:"静态权益",position_profit:"持仓盈亏",float_profit:"浮动盈亏",risk_ratio:"风险度",margin:"占用资金",frozen_margin:"冻结保证金",frozen_commission:"冻结手续费",frozen_premium:"冻结权利金",close_profit:"平仓盈亏"};return{columns1:[{title:t["balance"],key:"balance",align:"right",render:function(t,e){return t("div",q(e.row.balance))}},{title:t["available"],key:"available",align:"right",render:function(t,e){return t("div",q(e.row.available))}},{title:t["pre_balance"],key:"pre_balance",align:"right",render:function(t,e){return t("div",q(e.row.pre_balance))}},{title:t["deposit"],key:"deposit",align:"right",render:function(t,e){return t("div",q(e.row.deposit))}},{title:t["withdraw"],key:"withdraw",align:"right",render:function(t,e){return t("div",q(e.row.withdraw))}},{title:t["commission"],key:"commission",align:"right",render:function(t,e){return t("div",q(e.row.commission))}}],columns2:[{title:t["static_balance"],key:"static_balance",align:"right",render:function(t,e){return t("div",q(e.row.static_balance))}},{title:t["position_profit"],key:"position_profit",align:"right",render:function(t,e){return t("div",q(e.row.position_profit))}},{title:t["float_profit"],key:"float_profit",align:"right",render:function(t,e){return t("div",q(e.row.float_profit))}},{title:t["close_profit"],key:"close_profit",align:"right",render:function(t,e){return t("div",q(e.row.close_profit))}},{title:t["margin"],key:"margin",align:"right",render:function(t,e){return t("div",q(e.row.margin))}},{title:t["risk_ratio"],key:"risk_ratio",align:"right",render:function(t,e){return t("div",q(e.row.risk_ratio)+"%")}}]}},created:function(){this.account=this.$tqsdk.get_account(),this.$on("tqsdk:rtn_data",function(){this.$tqsdk.is_changed(this.account)&&this.$forceUpdate()})}},gt=_t,vt=(i("11b0"),Object(c["a"])(gt,pt,mt,!1,null,"7c967b21",null));vt.options.__file="TableAccounts.vue";var bt=vt.exports,yt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Table",{attrs:{height:t.height,columns:t.columns,data:t.positionsArr}})},wt=[],kt={data:function(){return{positionsArr:[],columns:[{title:"合约代码",key:"instrument_id",width:80,fixed:"left"},{title:"最新价",key:"last_price",width:80,align:"right",fixed:"left"},{title:"多仓",key:"volume_long",width:50,align:"right",className:"col-buy"},{title:"开仓均价",key:"open_price_long",width:80,align:"right",className:"col-buy",render:this.formatterPrice},{title:"持仓盈亏",key:"position_profit_long",width:80,align:"right",className:"col-buy",render:this.formatterPrice},{title:"操作",key:"action",width:150,align:"center",className:"col-buy",render:this.genButtons},{title:"空仓",key:"volume_short",width:50,align:"right",className:"col-sell"},{title:"开仓均价",key:"open_price_short",width:80,align:"right",className:"col-sell",render:this.formatterPrice},{title:"持仓盈亏",key:"position_profit_short",width:80,align:"right",className:"col-sell",render:this.formatterPrice},{title:"操作",key:"action",width:150,align:"center",className:"col-sell",render:this.genButtons},{title:"持仓占用",key:"margin",width:80,align:"right",render:this.formatterPrice}]}},props:{height:{type:String},loading:{type:Boolean,default:!1}},mounted:function(){this.$on("tqsdk:rtn_data",function(){var t=this.$tqsdk.get_positions();t&&this.$tqsdk.is_changed(t)&&M(t,this.positionsArr,function(t){return["exchange_id"]+"."+t["instrument_id"]},function(t){return t.volume_long>0||t.volume_short>0})})},methods:{formatterPrice:function(t,e){return t("div",q(e.row[e.column.key]))},genButtons:function(t,e){var i=this,n="col-buy"===e.column.className?"success":"error",r="col-buy"===e.column.className?"SELL":"BUY",s="col-buy"===e.column.className?e.row.volume_long:e.row.volume_short,a=[t("Button",{props:{type:n,size:"small"},style:{marginRight:"5px"},on:{click:function(){i.handleClose(e.index,e.row,r)}}},"平仓"),t("Button",{props:{type:n,size:"small"},style:{marginRight:"5px"},on:{click:function(){i.handleCloseOpen(e.index,e.row,r)}}},"反手")];return t("div",s>0?a:[])},handleClose:function(t,e,i){var n="BUY"===i?e.volume_short:e.volume_long;this.$tqsdk.insert_order({exchange_id:e.exchange_id,ins_id:e.instrument_id,direction:i,offset:"CLOSE",limit_price:e.last_price,volume:n})},handleCloseOpen:function(t,e,i){var n="BUY"===i?e.volume_short:e.volume_long;this.$tqsdk.insert_order({exchange_id:e.exchange_id,ins_id:e.instrument_id,direction:i,offset:"CLOSE",limit_price:e.last_price,volume:n}),this.$tqsdk.insert_order({exchange_id:e.exchange_id,ins_id:e.instrument_id,direction:i,offset:"OPEN",limit_price:e.last_price,volume:n})},rowClick:function(t,e,i){var n=t.exchange_id+"."+t.instrument_id;this.$store.commit("SET_SELECTED_SYMBOL",n)}}},Ct=kt,St=Object(c["a"])(Ct,yt,wt,!1,null,null,null);St.options.__file="TablePositions.vue";var Et=St.exports,xt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Table",{attrs:{height:t.height,columns:t.columns,data:t.ordersArr}})},Ot=[],Tt={data:function(){var t=this;return{ordersArr:[],columns:[{title:"委托单ID",key:"order_id",width:180,fixed:"left"},{title:"合约代码",key:"instrument_id",width:70,align:"center"},{title:"方向",key:"direction",width:50,align:"center",render:function(t,e){return t("div",P(e.row.direction))}},{title:"开平",key:"offset",width:50,align:"center",render:function(t,e){return t("div",$(e.row.offset))}},{title:"手数",key:"volume_orign",width:50,align:"right"},{title:"价格",key:"limit_price",width:70,align:"right"},{title:"未成交",key:"volume_left",width:60,align:"right"},{title:"操作",key:"action",width:80,align:"center",render:function(e,i){var n=e("Button",{props:{size:"small"},style:{marginRight:"5px"},on:{click:function(){t.handleCancelOrder(i.index,i.row)}}},"撤单");return"ALIVE"===i.row.status?e("div",[n]):e("div",[])}},{title:"状态",key:"status",width:100,align:"center",render:function(t,e){return"FINISHED"===e.row.status?t("div","已完成"):t("div","未完成")}},{title:"下单时间",key:"insert_date_time",width:160,align:"right",render:function(t,e){return t("div",I(e.row.insert_date_time))}},{title:"提示",key:"last_msg",width:180,align:"right"}]}},props:{height:{type:String}},mounted:function(){this.$on("tqsdk:rtn_data",function(){var t=this.$tqsdk.get_orders();this.$tqsdk.is_changed(t)&&M(t,this.ordersArr,"order_id",function(){return 1})})},methods:{filterStatus:function(t,e){return e.status===t},handleCancelOrder:function(t,e){this.$tqsdk.cancel_order(e.order_id)},rowClick:function(t,e,i){var n=t.exchange_id+"."+t.instrument_id;this.$store.commit("SET_SELECTED_SYMBOL",n)}}},Dt=Tt,jt=Object(c["a"])(Dt,xt,Ot,!1,null,null,null);jt.options.__file="TableOrders.vue";var qt=jt.exports,It=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Table",{attrs:{height:t.height,columns:t.columns,data:t.tradesArr}})},Pt=[],$t={data:function(){return{tradesArr:[],columns:[{title:"委托单ID",key:"order_id",width:180,fixed:"left"},{title:"交易所单号",key:"exchange_trade_id",width:100,align:"left"},{title:"合约代码",key:"instrument_id",width:100,align:"left"},{title:"方向",key:"direction",width:50,align:"center",render:function(t,e){return t("div",P(e.row.direction))}},{title:"开平",key:"offset",width:50,align:"center",render:function(t,e){return t("div",$(e.row.offset))}},{title:"手数",key:"volume",width:50,align:"right"},{title:"价格",key:"price",width:70,align:"right",render:function(t,e){return t("div",q(e.row.price))}},{title:"时间",key:"trade_date_time",width:160,align:"right",render:function(t,e){return t("div",I(e.row.trade_date_time))}},{title:"手续费",key:"commission",width:80,align:"right"}]}},props:{height:{type:String}},mounted:function(){this.$on("tqsdk:rtn_data",function(){var t=this.$tqsdk.get_trades();this.$tqsdk.is_changed(t)&&M(t,this.tradesArr,"trade_id",function(){return 1})})},methods:{filterInstrumentId:function(t,e){return e.instrument_id===t}}},Mt=$t,Nt=Object(c["a"])(Mt,It,Pt,!1,null,null,null);Nt.options.__file="TableTrades.vue";var At=Nt.exports,Rt={components:{TableAccounts:bt,TablePositions:Et,TableOrders:qt,TableTrades:At,SplitLeftRight:J},data:function(){return{split:.3,searchResult:[],selectedTab:"accounts",volume:1,priceTick:1,limitPrice:0,priceDecs:0,maxPrice:1/0,minPrice:0}},mounted:function(){var t=this;this.$store.subscribe(function(e,i){if("SET_SELECTED_SYMBOL"===e.type){var n=t.$tqsdk.get_quote(e.payload);n&&(t.priceTick=Number(n.price_tick),t.limitPrice=Number(n.last_price),t.priceDecs=Number(n.price_decs),t.maxPrice=0===n.upper_limit?1/0:Number(n.upper_limit),t.minPrice=0===n.lower_limit?0:Number(n.lower_limit))}})},computed:Object(p["a"])({height:function(){return this.$root.windowHeight*(1-this.$root.appSplit)-44+""},instrumentId:{get:function(){return this.innerInstrumentId},set:function(t){this.$store.commit("SET_SELECTED_SYMBOL",t)}}},Object(m["b"])({innerInstrumentId:"getSelectedInstrumentId"})),methods:{querySearch:function(t,e){this.searchResult=this.$tqsdk.get_quotes_by_input(t)},handleSelectInstrument:function(t){},insertOrder:function(t,e){var i=this.$tqsdk.get_quote(this.instrumentId);console.log(this.limitPrice),this.$tqsdk.insert_order({exchange_id:i.exchange_id,ins_id:i.ins_id,direction:t,offset:e,limit_price:this.limitPrice,volume:this.volume})}}},Lt=Rt,Ft=(i("e86d"),Object(c["a"])(Lt,dt,ft,!1,null,null,null));Ft.options.__file="UserTrade.vue";var Ht=Ft.exports,Wt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"user-login"},[t.showLoginError?i("Alert",{attrs:{type:"error","show-icon":"",closable:""},on:{"on-close":t.onclose}},[t._v("\n        "+t._s(t.errorMsg)+"\n    ")]):t._e(),i("Form",{ref:"userForm",attrs:{model:t.userForm,rules:t.rules,"label-width":80}},[i("FormItem",{attrs:{label:"期货公司",prop:"bid"}},[i("Select",{model:{value:t.userForm.bid,callback:function(e){t.$set(t.userForm,"bid",e)},expression:"userForm.bid"}},t._l(t.brokers,function(e){return i("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])}),1)],1),i("FormItem",{attrs:{label:"账号",prop:"user_name"}},[i("Input",{attrs:{placeholder:"请输入账号"},model:{value:t.userForm.user_name,callback:function(e){t.$set(t.userForm,"user_name",e)},expression:"userForm.user_name"}})],1),i("FormItem",{attrs:{label:"密码",prop:"password"}},[i("Input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:t.userForm.password,callback:function(e){t.$set(t.userForm,"password",e)},expression:"userForm.password"}})],1),i("FormItem",[i("Button",{attrs:{loading:t.loading,type:"primary"},on:{click:function(e){t.onSubmit("userForm")}}},[t._v("\n                登录\n            ")])],1)],1)],1)},Bt=[],Gt=(i("f751"),"等待回应超时,可能的原因 (1)服务器正在运维，(2)网络不通，无法连接服务器，请稍后/检查网络后重试。"),Ut={name:"userLogin",data:function(){return{brokers:[],errorMsg:Gt,userForm:Object.assign({bid:"",user_name:"",password:""},rt),rules:{bid:[{required:!0,message:"请选择期货公司",trigger:"blur"}],user_name:[{required:!0,message:"请输入账户",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},loading:!1,showLoginError:!1}},mounted:function(){this.$on("tqsdk:rtn_brokers",function(t){this.brokers=t})},methods:{onclose:function(){this.showLoginError=!1},onSubmit:function(t){var e=this;this.loading=!0,this.$refs[t].validate(function(t){if(t){e.$tqsdk.login({bid:e.userForm.bid,user_id:e.userForm.user_name,password:e.userForm.password});var i=setTimeout(function(){this.$tqsdk.is_logined()||(this.loading=!1,this.showLoginError=!0,this.errorMsg=Gt)}.bind(e),1e4);e.$on("tqsdk:rtn_data",function(){this.$tqsdk.is_logined()&&(this.loading=!1,this.showLoginError=!1,this.$store.commit("SET_LOGIN",!0),clearTimeout(i))}),e.$on("tqsdk:notify",function(t){"WARNING"!==t.level&&"ERROR"!==t.level||(this.loading=!1,this.showLoginError=!0,this.errorMsg=t.content)})}})}}},zt=Ut,Yt=(i("55b5"),Object(c["a"])(zt,Wt,Bt,!1,null,null,null));Yt.options.__file="UserLogin.vue";var Zt=Yt.exports,Qt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Modal",{attrs:{title:"确认结算单",closable:!1,"mask-closable":!1},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[i("div",{staticClass:"confirm-container"},[i("pre",[t._v(t._s(t.confirmContent))])]),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("Button",{attrs:{type:"primary"},on:{click:t.clickOk}},[t._v("确定")])],1)])},Xt=[],Jt={computed:{visible:function(){return"doing"===this.$store.state.confirm},confirmContent:function(){return this.$store.state.confirmContent}},methods:{clickOk:function(){this.$tqsdk.confirm_settlement(),this.$store.commit("SET_SETTLEMENT",{confirm:"done",confirmContent:""})}}},Kt=Jt,Vt=(i("4262"),Object(c["a"])(Kt,Qt,Xt,!1,null,"abc57b00",null));Vt.options.__file="UserConfirmSettlement.vue";var te=Vt.exports,ee={name:"user",components:{Trade:Ht,Login:Zt,Confirm:te}},ie=ee,ne=Object(c["a"])(ie,ht,ut,!1,null,null,null);ne.options.__file="User.vue";var re=ne.exports,se=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"charts-container"},[i("Chart",{attrs:{instrumentId:t.instrumentId,height:t.height}})],1)},ae=[],oe=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"chart",style:{height:t.height+"px"},on:{keyup:t.onKeyUp}},[i("RadioGroup",{attrs:{size:"small",type:"button"},model:{value:t.selectedPeriod,callback:function(e){t.selectedPeriod=e},expression:"selectedPeriod"}},t._l(t.periods,function(e){return i("Radio",{key:e,attrs:{label:e}},[t._v("\n            "+t._s(e)+"\n        ")])}),1),t._v("\n     \n    "),i("Checkbox",{attrs:{label:"ma"},on:{"on-change":function(e){t.onchange("ma3")}},model:{value:t.indicators.ma3.show,callback:function(e){t.$set(t.indicators.ma3,"show",e)},expression:"indicators.ma3.show"}},[t._v("MA3")]),i("Checkbox",{attrs:{label:"ma"},on:{"on-change":function(e){t.onchange("ma10")}},model:{value:t.indicators.ma10.show,callback:function(e){t.$set(t.indicators.ma10,"show",e)},expression:"indicators.ma10.show"}},[t._v("MA10")]),i("Checkbox",{attrs:{label:"ma"},on:{"on-change":function(e){t.onchange("ma30")}},model:{value:t.indicators.ma30.show,callback:function(e){t.$set(t.indicators.ma30,"show",e)},expression:"indicators.ma30.show"}},[t._v("MA30")]),i("Checkbox",{attrs:{label:"boll"},on:{"on-change":function(e){t.onchange("boll")}},model:{value:t.indicators.boll.show,callback:function(e){t.$set(t.indicators.boll,"show",e)},expression:"indicators.boll.show"}},[t._v("BOLL")]),i("div",{ref:"CHART",style:{height:t.height-30+"px"},attrs:{id:"CHART"}})],1)},ce=[],le=(i("ac6a"),i("456d"),i("5698")),he=(i("673e"),i("d4ec")),ue=i("bee2"),de=i("ade3"),fe=i("99de"),pe=i("7e84"),me=i("262e"),_e=i("257e"),ge=function(){function t(){Object(he["a"])(this,t),this.handlers={},this.on=this.addEventListener,this.emit=this.fire,this.off=this.removeEventListener}return Object(ue["a"])(t,[{key:"addEventListener",value:function(e,i){var n=this;t.ToArray(e).forEach(function(t){(n.handlers[t]||(n.handlers[t]=[])).push(i)})}},{key:"removeEventListener",value:function(e,i){var n=this;t.ToArray(e).forEach(function(t){if(n.handlers[t]instanceof Array){for(var e=n.handlers[t],r=0;r<e.length;r++)if(e[r]===i){n.handlers[t].splice(r,1);break}0===n.handlers[t].length&&delete n.handlers[t]}})}},{key:"fire",value:function(t,e){if(this.handlers[t]instanceof Array)for(var i=this.handlers[t],n=0;n<i.length;n++)i[n](e)}}],[{key:"ToArray",value:function(t){return Array.isArray(t)?t:[t]}}]),t}(),ve=i("3835"),be=(i("ffc1"),i("20d6"),i("4917"),i("9b39")),ye=i.n(be),we=new ye.a({symbolsServerUrl:"https://openmd.shinnytech.com/t/md/symbols/latest.json",wsQuoteUrl:"wss://openmd.shinnytech.com/t/md/front/mobile",wsTradeUrl:"wss://t.shinnytech.com/trade/shinny",reconnectInterval:3e3,reconnectMaxTimes:5,prefix:"web"}),ke=Number(n["default"].version.split(".")[0]),Ce=function(){},Se={},Ee={},xe=/^global:/,Oe={},Te=/^tqsdk:/;function De(t){var e=t.prototype.$on,i=t.prototype.$emit;t.prototype.$on=function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ce,n=this;if(Array.isArray(t))t.forEach(function(t){return n.$on(t,i)});else if(xe.test(t))(Ee[n._uid]||(Ee[n._uid]=[])).push(t),(Se[t]||(Se[t]=[])).push(n),e.call(n,t,i);else if(Te.test(t)){Oe[n._uid]||(Oe[n._uid]={});var r=t.match(/^tqsdk:(.*)/)[1];Oe[n._uid][r]||(Oe[n._uid][r]=[]),Oe[n._uid][r].push(i),we.on(r,i.bind(n))}else e.call(n,t,i);return n},t.prototype.$emit=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var s=this;if(xe.test(t)){var a=Se[t]||[];a.forEach(function(e){return i.apply(e,[t].concat(n))})}else i.apply(s,[t].concat(n));return s}}function je(t){t.mixin({beforeDestroy:function(){var t=this,e=Ee[t._uid]||[];e.forEach(function(e){var i=Se[e].findIndex(function(e){return e._uid===t._uid});Se[e].splice(i,1)}),delete Ee[t._uid];var i=Oe[t._uid]||{},n=function(t){var e=i[t];e.forEach(function(e){we.removeEventListener(t,e)})};for(var r in i)n(r);delete Oe[t._uid],Object.entries(Se).forEach(function(t){var e=Object(ve["a"])(t,2),i=e[0],n=e[1];return n.length||delete Se[i]})}})}function qe(t){ke<2?console.error("[vue-event-proxy] only support Vue 2.0+"):qe.installed||(qe.installed=!0,De(t),je(t))}n["default"].use(qe),n["default"].$tqsdk=we,n["default"].prototype.$tqsdk=we;var Ie=we,Pe=function(t){function e(t){var i;return Object(he["a"])(this,e),i=Object(fe["a"])(this,Object(pe["a"])(e).call(this)),i.dm=t.dm,i.ws=t.ws,i.xScale=t.xScale,i._symbol=t.symbol?t.symbol:null,i._duration=t.duration?t.duration:null,i._width=t.width?t.width:null,i._barWidth=e.BAR_WIDTH_DEFAULT,i._barPadding=Math.max(1,Math.round(i._barWidth*e.BAR_PADDING_RATE)),i._barNumbers=Math.floor(i._width/i._barWidth),i._left_id=-1,i._right_id=-1,i.klinesPath&&(Ie.on("rtn_data",i.update.bind(Object(_e["a"])(Object(_e["a"])(i)))),i.sendToServer()),i}return Object(me["a"])(e,t),Object(ue["a"])(e,[{key:"resetChartParams",value:function(){this._barNumbers=Math.floor(this._width/this._barWidth),this._barPadding=Math.max(1,Math.round(this._barWidth*e.BAR_PADDING_RATE));var t=this._right_id-this._barNumbers+1;this._left_id=t<0?0:t,this._right_id=this._left_id+this._barNumbers-1,this.sendToServer()}},{key:"update",value:function(){this.klines&&this.klines.last_id&&this.klines.last_id>-1&&(-1===this._left_id||-1===this._right_id?this.chart_right_id&&this.chart_right_id>-1&&(this._right_id=this.chart_right_id,this._left_id=this._right_id-this._barNumbers+1,this.fire("update")):(this._right_id>=this.klines.last_id-1&&(this._right_id=this._right_id+1===this.klines.last_id?this._right_id+1:this._right_id,this._left_id=this._right_id-this._barNumbers+1),this.fire("update")))}},{key:"moves",value:function(t){if(-1!==this._left_id){var e=this._left_id-t,i=e+this._barNumbers-1,n=this.klines.last_id;if(e>=0&&e<=n){var r=[e,i];return this._left_id=r[0],this._right_id=r[1],this.sendToServer(),!0}return!1}}},{key:"sendToServer",value:function(){this.symbol&&this.duration&&(this._right_id>-1&&this._right_id!==this.last_id?this.ws.send({aid:"set_chart",chart_id:e.CHART_ID,ins_list:this.symbol,duration:this.duration,view_width:2*this._barNumbers,left_kline_id:this._left_id-this._barNumbers}):this.ws.send({aid:"set_chart",chart_id:e.CHART_ID,ins_list:this.symbol,duration:this.duration,view_width:2*this._barNumbers}))}},{key:"width",set:function(t){this._width=t,this.resetChartParams()}},{key:"barWidth",set:function(t){t=t%2===0?t+1:t,t<e.BAR_NUMBERS_MIN||t>e.BAR_NUMBERS_MAX||t===this._barWidth||(this._barWidth=t,this.resetChartParams())},get:function(){return this._barWidth}},{key:"barPadding",get:function(){return this._barPadding}},{key:"barNumbers",get:function(){return this._barNumbers}},{key:"symbol",get:function(){return this._symbol},set:function(t){this._symbol!==t&&(this._symbol=t,this._left_id=this._right_id=-1,this.sendToServer())}},{key:"duration",get:function(){return this._duration},set:function(t){this._duration!==t&&(this._duration=t,this._left_id=this._right_id=-1,this.sendToServer())}},{key:"klinesPath",get:function(){return this.symbol&&this.duration?"klines/"+this.symbol+"/"+this.duration:""}},{key:"ticksPath",get:function(){return this.symbol&&0===this.duration?"ticks/"+this.symbol:""}},{key:"quote",get:function(){return this._symbol?this.dm.get_quote(this.symbol):null}},{key:"chart",get:function(){return this.dm.get_by_path("charts/"+e.CHART_ID)}},{key:"klines",get:function(){return this._symbol&&this._duration?this.dm.get_klines(this._symbol,this._duration):null}},{key:"ticks",get:function(){return this._symbol?this.dm.getKlines(this._symbol):null}},{key:"left_id",get:function(){return this._left_id}},{key:"right_id",get:function(){return this._right_id}},{key:"chart_left_id",get:function(){return this.chart&&this.chart.state&&this.chart.state.duration===this._duration&&this.chart.state.ins_list===this._symbol&&this.chart.left_id?this.chart.left_id:-1}},{key:"chart_right_id",get:function(){return this.chart&&this.chart.state&&this.chart.state.duration===this._duration&&this.chart.state.ins_list===this._symbol&&this.chart.right_id?this.chart.right_id:-1}},{key:"chart_last_id",get:function(){return this.klines&&this.klines.last_id?this.klines.last_id:-1}}]),e}(ge);Object(de["a"])(Pe,"CHART_ID","web_kline_chart"),Object(de["a"])(Pe,"BAR_PADDING_RATE",.1),Object(de["a"])(Pe,"BAR_WIDTH_DEFAULT",9),Object(de["a"])(Pe,"BAR_NUMBERS_MAX",55),Object(de["a"])(Pe,"BAR_NUMBERS_MIN",3);var $e=i("1341"),Me=function(){return{up:function(t){return t.open<t.close},down:function(t){return t.open>t.close},equal:function(t){return t.open===t.close}}},Ne=Me(),Ae=function(){function t(e){Object(he["a"])(this,t),this.name=e.name?e.name:(new Date).getTime(),this.plot=e.plot?e.plot:null,this.chartDm=this.plot.chartDm,this.types=["line","body"]}return Object(ue["a"])(t,[{key:"createPaths",value:function(){var t=this;return this.paths=[],Object.keys(Ne).forEach(function(e){return t.paths.push([t.name,"line",e].join("."))}),Object.keys(Ne).forEach(function(e){return t.paths.push([t.name,"body",e].join("."))}),this.paths}},{key:"calcPaths",value:function(t,e,i){var n=this;if(this.plot.yScale&&this.plot.xScale&&this.chartDm){var r={};this.paths.forEach(function(t){return r[t]=""});for(var s=function(t){if(!i[t])return"continue";Object.keys(Ne).forEach(function(e){Ne[e](i[t])&&(r[[n.name,"body",e].join(".")]+=n.bodyPath(i[t],t),r[[n.name,"line",e].join(".")]+=n.linePath(i[t],t))})},a=t;a<=e;a++)s(a);return r}}},{key:"bodyPath",value:function(t,e){var i=Math.round(this.plot.yScale(t.open)),n=Math.round(this.plot.yScale(t.close)),r=this.plot.xScale(e)+this.chartDm.barPadding,s=this.chartDm.barWidth-2*this.chartDm.barPadding,a="";return a=t.open!==t.close?"M ".concat(r," ").concat(i," L ").concat(r+s," ").concat(i," L ").concat(r+s," ").concat(n," L ").concat(r," ").concat(n," L ").concat(r," ").concat(i):"M ".concat(r," ").concat(i+.5," L ").concat(r+s," ").concat(i+.5),a}},{key:"linePath",value:function(t,e){var i=Math.round(this.plot.yScale(t.high)),n=Math.round(this.plot.yScale(t.low)),r=this.plot.xScale(e)+this.chartDm.barWidth/2,s="M ".concat(r," ").concat(i," L ").concat(r," ").concat(n);return s}}]),t}(),Re=Ae,Le=function(){return{up:function(t){return t.open<=t.close},down:function(t){return t.open>t.close}}},Fe=Le(),He=function(){function t(e){Object(he["a"])(this,t),this.name=e.name?e.name:(new Date).getTime(),this.plot=e.plot?e.plot:null,this.chartDm=this.plot.chartDm}return Object(ue["a"])(t,[{key:"createPaths",value:function(){var t=this;return this.paths=[],Object.keys(Fe).forEach(function(e){return t.paths.push([t.name,"body",e].join("."))}),this.paths}},{key:"calcPaths",value:function(t,e,i){var n=this;if(this.plot.yScale&&this.plot.xScale&&this.chartDm){var r={};this.paths.forEach(function(t){return r[t]=""});for(var s=function(t){if(!i[t])return"continue";Object.keys(Fe).forEach(function(e){Fe[e](i[t])&&(r[[n.name,"body",e].join(".")]+=n.bodyPath(i[t],t,"up"===e?0:.5))})},a=t;a<=e;a++)s(a);return r}}},{key:"bodyPath",value:function(t,e,i){var n=Math.floor(this.plot.yScale(0)),r=Math.round(n-this.plot.yScale(t.volume)),s=this.plot.xScale(e)+this.chartDm.barPadding,a=this.chartDm.barWidth-2*this.chartDm.barPadding,o="M ".concat(s+i," ").concat(n-i," L ").concat(s+a-i," ").concat(n-i," L ").concat(s+a-i," ").concat(n-r+i," L ").concat(s+i," ").concat(n-r+i," L ").concat(s+i," ").concat(n-i);return o}}]),t}(),We=He,Be=function(){function t(e){Object(he["a"])(this,t),this.name=e.name?e.name:(new Date).getTime(),this.plot=e.plot?e.plot:null,this.chartDm=this.plot.chartDm}return Object(ue["a"])(t,[{key:"createPaths",value:function(){return this.paths=["oi"],this.paths}},{key:"calcPaths",value:function(t,e,i){if(this.plot.yScale&&this.plot.xScale&&this.chartDm){for(var n="",r=t;r<=e;r++)if(i[r]){var s=this.plot.yScale(i[r].close_oi),a=this.plot.xScale(r)+this.chartDm.barWidth/2;n+=""===n?"M":"L",n+="".concat(a," ").concat(s," ")}return{oi:n}}}}]),t}(),Ge=Be,Ue={up:function(t){return t.open<=t.close},down:function(t){return t.open>t.close}},ze={up:function(t){return t.open<t.close},down:function(t){return t.open>t.close},equal:function(t){return t.open===t.close}},Ye=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(he["a"])(this,t),this.calculator=e.calculator,this.name=e.name?e.name:(new Date).getTime(),this.plot=e.plot?e.plot:null,this.chartDm=this.plot.chartDm,this.pathClasses=[],this.type="MAIN"}return Object(ue["a"])(t,[{key:"createPaths",value:function(){for(var t=this,e=function(e){var i=t.calculator.paths[e].name,n=t.calculator.paths[e].type;"colorBar"===n?Object.keys(Ue).forEach(function(e){t.pathClasses.push([t.name,i,e].join("."))}):"candle"===n?["line","body"].forEach(function(e){Object.keys(ze).forEach(function(n){t.pathClasses.push([t.name,i,e,n].join("."))})}):t.pathClasses.push([t.name,i].join("."))},i=0;i<this.calculator.paths.length;i++)e(i);return this.pathClasses}},{key:"calcPaths",value:function(e,i,n){var r=this;if(this.plot.yScale&&this.plot.xScale&&this.chartDm){var s={};this.pathClasses.forEach(function(t){return s[t]=""});for(var a=function(n){var a=r.calculator.paths[n].name,o=r.name+"."+r.calculator.paths[n].name,c=r.calculator.paths[n].type;if("line"===c){for(var l=e;l<=i;l++)if(r.calculator[a][l]){var h=r.linePath(r.calculator[a][l],l);s[o]+=""===s[o]?"M ".concat(h):"L ".concat(h)}}else if("bar"===c){for(var u=r.plot.yScale(0),d=e;d<=i;d++)if(r.calculator[a][d]){var f=r.linePath(r.calculator[a][d],u,d);s[o]+=f}}else"colorBar"===c&&function(){for(var n=r.plot.yScale(0),c=function(e){if(!r.calculator[a][e])return"continue";Object.keys(Ue).forEach(function(i){if(i(r.chartDm.klines.data[e])){var c=r.linePath(r.calculator[a][e],n,e,"down"===i?t.HollowBarDiff:0);s[o+"."+i]+=c}})},l=e;l<=i;l++)c(l)}()},o=0;o<this.calculator.paths.length;o++)a(o);return s}}},{key:"linePath",value:function(t,e){var i=this.plot.yScale(t),n=this.plot.xScale(e)+this.chartDm.barWidth/2;return"".concat(n," ").concat(i)}},{key:"barPath",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=Math.round(e-this.plot.yScale(t)),s=Math.round(this.plot.xScale(i)+this.chartDm.barPadding),a=this.chartDm.barWidth-2*this.chartDm.barPadding;return"M ".concat(s+n," ").concat(e," L ").concat(s+a-n," ").concat(e," L ").concat(s+a-n," ").concat(e-r," L ").concat(s+n," ").concat(e-r," L ").concat(s+n," ").concat(e)}}]),t}();Object(de["a"])(Ye,"HollowBarDiff",.5);var Ze=Ye,Qe=function(){function t(e){Object(he["a"])(this,t),this.parentG=e.parentG,this.name=e.name,this.g=this.parentG.append("g").attr("class",this.name),this._top=e.top?e.top:0,this._left=e.left?e.left:0,this._height=e.height?e.height:0,this._width=e.width?e.width:0,this.g.attr("transform","translate("+this._left+","+this._top+")").attr("height",this._height).attr("width",this._width)}return Object(ue["a"])(t,[{key:"appendPlotPathClasses",value:function(e){this.g.selectAll("path").data(e,function(e){return t.ArrayJoin(e,".")}).enter().append("path").attr("class",function(e){return t.ArrayJoin(e," ")}).exit().remove()}},{key:"appendPlotPaths",value:function(e){var i=e instanceof Array?e:null;if("object"===Object(j["a"])(e)&&(i=[],Object.keys[e].forEach(function(t){i.push(e[t])})),null!==i){var n=this.g.selectAll("path").data(i,function(e){return t.ArrayJoin(e.classes,".")});n.exit().remove(),n.enter().append("path").attr("class",function(e){return t.ArrayJoin(e.classes," ")}).merge(n).attr("d",function(t){return t.paths})}}},{key:"top",value:function(t){return t&&(this._top=t,this.g.attr("transform","translate("+this._left+","+this._top+")")),this._top}},{key:"left",value:function(t){return t&&(this._left=t,this.g.attr("transform","translate("+this._left+","+this._top+")")),this._left}},{key:"height",value:function(t){return t&&(this._height=t,this.g.attr("height",this._height)),this._height}},{key:"width",value:function(t){return t&&(this._width=t,this.g.attr("width",this._width)),this._width}}],[{key:"ArrayJoin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return t instanceof Array?t.join(e):"string"===typeof t?t:""}}]),t}(),Xe=function(t){function e(t){var i;return Object(he["a"])(this,e),i=Object(fe["a"])(this,Object(pe["a"])(e).call(this,t)),i.type=t.type,i.xScale=t.xScale,i.chartDm=t.chartDm,i.yScale=le["g"]().range([t.height,0]),i.yAxis="right"===t.yAxisPos?le["c"]().scale(i.yScale):i.yAxis=le["b"]().scale(i.yScale),i.g.append("g").attr("class","y axis "+("right"===t.yAxisPos?"right":"")),"right"===t.yAxisPos&&i.g.select("g.y.axis.right").attr("transform","translate("+t.width+",0)"),i.init(),i}return Object(me["a"])(e,t),Object(ue["a"])(e,[{key:"init",value:function(){var t=this;switch(this.type){case"candle":this.path=new Re({name:this.name,plot:this});break;case"volume":this.path=new We({name:this.name,plot:this});break;case"oi":this.path=new Ge({name:this.name,plot:this});break}this.path&&this.path.createPaths().forEach(function(e){t.appendPlotTypePath(e.split("."))}),this.indicators={}}},{key:"addIndicator",value:function(t){var e=this;switch(t.name){case"ma":this.indicators[t.id]=new Ze({calculator:t.calculator,name:t.id,plot:this});break;case"boll":this.indicators[t.id]=new Ze({calculator:t.calculator,name:t.id,plot:this});break}this.indicators[t.id]&&this.indicators[t.id].createPaths().forEach(function(i){i=t.id+"."+i,e.appendPlotTypePath(i.split("."))})}},{key:"appendPathsGroupBy",value:function(t){var e=this;Object.keys(t).forEach(function(t){e.appendPlotTypePath([e.name,t])})}},{key:"appendPlotTypePath",value:function(t){this.g.selectAll("path.".concat(e.ArrayJoin(t,"."))).data(function(t){return[t]}).enter().append("path").attr("class","".concat(e.ArrayJoin(t," ")))}},{key:"getYPriceRange",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=1/0,r=-1/0;if(i){for(var s=0,a=t;a<=e;a++){var o=this.chartDm.klines[a];s=Math.max(Math.abs(o.high-i),Math.abs(o.low-i),s)}n=i-s,r=i+s}else{for(var c=t;c<=e;c++){var l=this.chartDm.klines[c];l&&(n=Math.min(n,l.low),r=Math.max(r,l.high))}if(this.chartDm.quote&&this.chartDm.quote.price_tick){var h=20*this.chartDm.quote.price_tick;n-=h,r+=h}}return[n,r]}},{key:"getYMaxRange",value:function(t,e,i){for(var n=-1/0,r=t;r<=e;r++){var s=this.chartDm.klines[r];s&&(n=Math.max(n,s[i]))}return n}},{key:"getYMinRange",value:function(t,e,i){for(var n=1/0,r=t;r<=e;r++){var s=this.chartDm.klines[r];s&&(n=Math.min(n,s[i]))}return n}},{key:"draw",value:function(){var t=null;switch(this.type){case"candle":t=this.getYPriceRange(this.chartDm.left_id,this.chartDm.right_id);break;case"volume":t=[0,this.getYMaxRange(this.chartDm.left_id,this.chartDm.right_id,"volume")];break;case"oi":t=[this.getYMinRange(this.chartDm.left_id,this.chartDm.right_id,"close_oi"),this.getYMaxRange(this.chartDm.left_id,this.chartDm.right_id,"close_oi")];break}this.yScale.domain(t),this.g.selectAll("g.y.axis").call(this.yAxis);var e=this.path.calcPaths(this.chartDm.left_id,this.chartDm.right_id,this.chartDm.klines);for(var i in e)this.g.select("path.".concat(i)).attr("d",e[i]);for(var n in this.indicators)this.indicators[n].calculator.calc(this.chartDm.left_id,this.chartDm.right_id,this.chartDm.klines);for(var r in this.indicators){var s=this.indicators[r].calcPaths(this.chartDm.left_id,this.chartDm.right_id,this.chartDm.klines);for(var a in s)this.g.select("path.".concat(r,".").concat(a)).attr("d",s[a])}}},{key:"showIndicator",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];for(var i in this.indicators)i===t&&this.g.selectAll("path.".concat(i)).attr("visibility",e?"visible":"hidden")}},{key:"height",set:function(t){Object($e["a"])(Object(pe["a"])(e.prototype),"height",t,this,!0),this.yScale.range([t,0])}},{key:"width",set:function(t){Object($e["a"])(Object(pe["a"])(e.prototype),"width",t,this,!0),this.g.select("g.y.axis.right").attr("transform","translate("+t+",0)")}}],[{key:"ArrayJoin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return t.length?t.join(e):""}},{key:"UpDownEqual",value:function(){return{up:function(t){return t.open<t.close},down:function(t){return t.open>t.close},equal:function(t){return t.open===t.close}}}}]),e}(Qe),Je=Xe,Ke=function(){function t(e){Object(he["a"])(this,t),this.parentG=e.parentG,this.name=e.name,this.g=this.parentG.append("g").attr("class",this.name),this._text="正在加载数据",this._isShow=!!e.show&&e.show,this.textG=this.g.append("text").attr("x","50%").attr("y","50%").attr("text-anchor","middle").attr("font-size",50).text(this._text).attr("visibility",this._isShow?"visible":"hidden")}return Object(ue["a"])(t,[{key:"show",get:function(){return this._isShow},set:function(t){this._isShow=t,this.textG.attr("visibility",this._isShow?"visible":"hidden")}},{key:"text",get:function(){return this._text},set:function(t){this._text=t,this.textG.text(String(t))}}]),t}(),Ve=i("45eb"),ti=function(t){function e(t){var i;Object(he["a"])(this,e),i=Object(fe["a"])(this,Object(pe["a"])(e).call(this,t)),i.chartDm=t.chartDm;var n=Object(_e["a"])(Object(_e["a"])(i));return i.g.selectAll("rect").data([0]).enter().append("rect").attr("width",Object(Ve["a"])(Object(pe["a"])(e.prototype),"width",Object(_e["a"])(i))).attr("height",Object(Ve["a"])(Object(pe["a"])(e.prototype),"height",Object(_e["a"])(i))).attr("fill-opacity",0).on("mouseover",function(){n.show()}).on("mousemove",function(){var t=le["f"](this),e=Object(ve["a"])(t,2),i=e[0],r=e[1],s=Math.floor(i/n.chartDm.barWidth),a=s*n.chartDm.barWidth+n.chartDm.barWidth/2;if(n.chartDm.klines&&n.chartDm.klines.data){var o=n.chartDm.klines.data[n.chartDm.left_id+s];o||(o={high:"",open:"",low:"",close:""});var c="高 ".concat(o.high," 开 ").concat(o.open," 低 ").concat(o.low," 收 ").concat(o.close);n.g.select("g.text text").text(c)}var l=n.g.select("g.crosshair.horizontal line"),h=n.g.select("g.crosshair.vertical line");l.attr("y1")!==r&&l.attr("y1",r).attr("y2",r),h.attr("x1")!==a&&h.attr("x1",a).attr("x2",a)}).on("mouseleave",function(){n.hide()}),i.g.append("g").attr("class","crosshair horizontal").append("line").attr("x1",0).attr("y1",0).attr("x2",Object(Ve["a"])(Object(pe["a"])(e.prototype),"width",Object(_e["a"])(i))).attr("y2",0).attr("stroke","#bbbbbb").attr("stroke-dasharray","2 4").attr("visibility","hidden"),i.g.append("g").attr("class","crosshair vertical").append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",Object(Ve["a"])(Object(pe["a"])(e.prototype),"height",Object(_e["a"])(i))).attr("stroke","#bbbbbb").attr("stroke-dasharray","2 4").attr("visibility","hidden"),i.g.append("g").attr("class","text").append("text").attr("fill","grey").attr("x",0).attr("y",0),i.g.append("g").attr("class","axisannotation x"),i.g.append("g").attr("class","axisannotation y"),i}return Object(me["a"])(e,t),Object(ue["a"])(e,[{key:"show",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.g.selectAll("g.crosshair line").attr("visibility",t?"visible":"hidden")}},{key:"hide",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.g.selectAll("g.crosshair line").attr("visibility",t?"visible":"hidden")}},{key:"height",set:function(t){Object($e["a"])(Object(pe["a"])(e.prototype),"height",t,this,!0),this.g.select("g.crosshair.vertical line").attr("y2",t),this.g.select("rect").attr("height",t)}},{key:"width",set:function(t){Object($e["a"])(Object(pe["a"])(e.prototype),"width",t,this,!0),this.g.select("g.crosshair.horizontal line").attr("x2",t),this.g.select("rect").attr("width",t)}}]),e}(Qe);function ei(t,e,i){for(var n=0,r=i-e+1;r<=i&&!isNaN(n);r++)n+=t[r];return n}function ii(t,e,i,n){return 0!=n.length&&n[t-1]?n[t-1]-e[t-i]/i+e[t]/i:ei(e,i,t)/i}function ni(t,e,i,n){n._s=n._s?n._s:[];var r=0,s=0;if(n._s[t-1])s=n._s[t-1][0]-e[t-i]+e[t],r=n._s[t-1][1]-e[t-i]*e[t-i]+e[t]*e[t];else for(var a=t-i+1;a<=t;a++){var o=e[a];r+=o*o,s+=o}var c=r-s*s/i;c<0&&c>-1e-6&&(c=Math.abs(c));var l=1==i?1:i-1,h=Math.sqrt(c/l);return isNaN(h)||(n._s[t]=[s,r]),h}var ri=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(he["a"])(this,t),this.params=e.params?e.params:5,this.paths=[{name:"ma",type:"line"}],this.ma=[]}return Object(ue["a"])(t,[{key:"calc",value:function(t,e,i){for(var n=t;n<=e;n++)this.ma[n]||(this.ma[n]=ii(n,i.close,this.params,this.ma));return this.ma}},{key:"range",value:function(t,e){for(var i=NaN,n=NaN,r=t;r<=e;r++)this.ma[r]&&(n=n?Math.max(n,this.ma[r]):this.ma[r],i=i?Math.min(i,this.ma[r]):this.ma[r]);return[i,n]}}]),t}(),si=ri,ai=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(he["a"])(this,t),this.n=e.pramas&&e.pramas.n?e.pramas.n:10,this.p=e.pramas&&e.pramas.p?e.pramas.p:3,this.paths=[{name:"top",type:"line"},{name:"bottom",type:"line"}],this._mid=[],this._std=[],this.top=[],this.bottom=[]}return Object(ue["a"])(t,[{key:"calc",value:function(t,e,i){for(var n=t;n<=e;n++)this.top[n]&&this.bottom[n]||(this._mid[n]=ii(n,i.close,this.n,this._mid),this._std[n]=ni(n,i.close,this.n,this._std),this.top[n]=this._mid[n]+this.p*this._std[n],this.bottom[n]=this._mid[n]-this.p*this._std[n]);return{top:this.top,bottom:this.bottom}}},{key:"range",value:function(t,e){for(var i=NaN,n=NaN,r=t;r<=e;r++)this.top[r]&&this.bottom[r]&&(n=n?Math.max(n,this.top[r]):this.top[r],i=i?Math.min(i,this.bottom[r]):this.bottom[r]);return[i,n]}}]),t}(),oi=ai,ci=le["j"](".%L"),li=le["j"](":%S"),hi=le["j"]("%H:%M"),ui=le["j"]("%H:%M"),di=le["j"]("%m%d"),fi=le["j"]("%m%d"),pi=le["j"]("%y");function mi(t){return(le["n"](t)<t?ci:le["l"](t)<t?li:le["k"](t)<t?hi:le["i"](t)<t?ui:le["m"](t)<t?di:le["o"](t)<t?fi:pi)(t)}var _i=function(){function t(e,i,n){Object(he["a"])(this,t),this._height=i,this._width=n,this._plotsNumber=e||2,this.positions=[],this.initLayout()}return Object(ue["a"])(t,[{key:"initLayout",value:function(){var e=1/this.plotsNumber,i=e+.3*e*(this.plotsNumber-1),n=.7*e,r=this.height-t.PLOT_PADDING*(this.plotsNumber-1);this.positions[0]={width:this._width,height:r*i,top:0};for(var s=1;s<this.plotsNumber;s++)this.positions[s]={width:this._width,height:r*n,top:this.positions[s-1].top+this.positions[s-1].height+t.PLOT_PADDING}}},{key:"width",set:function(t){this._width=t,this.initLayout()},get:function(){return this._width}},{key:"height",set:function(t){this._height=t,this.initLayout()},get:function(){return this._height}},{key:"plotsNumber",set:function(t){this._plotsNumber=t,this.initLayout()},get:function(){return this._plotsNumber}}]),t}();Object(de["a"])(_i,"PLOT_PADDING",2);var gi=function(){function t(e){Object(he["a"])(this,t),this.divDomId=e.id,this.outerWidth=e.width,this.outerHeight=e.height,this.margin=e.margin?e.margin:{top:10,right:50,bottom:30,left:50},this.innerWidth=this.outerWidth-this.margin.left-this.margin.right,this.innerHeight=this.outerHeight-this.margin.top-this.margin.bottom,this._symbol=e.symbol?e.symbol:"",this._duration=e.duration?e.duration:"",this.chartDm=new Pe({dm:e.dm,ws:e.ws,symbol:e.instrumentId,duration:e.duration,width:this.innerWidth}),this.chartDm.addEventListener("update",this.draw.bind(this)),this.indicators={},this.init(),this.plotsManager=new _i(2,this.innerHeight,this.innerWidth),this.mainPlot=new Je({name:"candle",type:"candle",xScale:this.xScale,chartDm:this.chartDm,parentG:this.rootG,width:this.innerWidth,height:this.plotsManager.positions[0].height,top:this.plotsManager.positions[0].top,left:0}),this.subPlots={volume:new Je({name:"volume",type:"volume",xScale:this.xScale,chartDm:this.chartDm,parentG:this.rootG,width:this.innerWidth,height:this.plotsManager.positions[1].height,top:this.plotsManager.positions[1].top,left:0}),oi:new Je({name:"oi",type:"oi",xScale:this.xScale,chartDm:this.chartDm,parentG:this.rootG,yAxisPos:"right",width:this.innerWidth,height:this.plotsManager.positions[1].height,top:this.plotsManager.positions[1].top,left:0})}}return Object(ue["a"])(t,[{key:"init",value:function(){this.svg=le["h"]("#"+this.divDomId).append("svg").attr("width",this.outerWidth).attr("height",this.outerHeight),this.rootG=this.svg.append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.loading=new Ke({parentG:this.svg,name:"loading",show:!0}),this.xScale=le["g"](),this.xAxis=le["a"]().scale(this.xScale),this.rootG.append("g").attr("class","x axis").attr("transform","translate("+this.chartDm.barWidth/2+","+(this.innerHeight+.5)+")"),this.crosshair=new ti({parentG:this.svg,name:"crosshair",width:this.innerWidth,height:this.innerHeight,left:this.margin.left,top:this.margin.top,chartDm:this.chartDm});var e=null,i=this,n=le["d"]().on("start",function(){e=le["e"].x,i.crosshair.hide()}).on("drag",function(){var t=Math.round((le["e"].x-e)/i.chartDm.barWidth);Math.abs(t)>0&&(e=le["e"].x,i.move(t))}).on("end",function(){e=null,i.crosshair.show()});this.svg.call(n);var r=0,s=le["p"]().on("zoom",function(){if(r+=le["e"].sourceEvent.deltaY,Math.abs(r)>=t.ZOOM_SENSITIVITY){var e=Math.round(Math.abs(r)/t.ZOOM_SENSITIVITY);e=r>0?e:-e,i.debounce(i.zoom,200).bind(i)(e),r=0}});this.svg.call(s).on("dblclick.zoom",null)}},{key:"debounce",value:function(t,e){var i=null;return function(){var n=this,r=arguments;clearTimeout(i),i=setTimeout(function(){t.apply(n,r)},e)}}},{key:"addIndicator",value:function(t){var e=t.id;switch(this.indicators[e]=t,t.name){case"ma":this.indicators[e].calculator=new si(t);break;case"boll":this.indicators[e].calculator=new oi(t);break}this.mainPlot.addIndicator(this.indicators[e])}},{key:"showIndicator",value:function(t){this.mainPlot.showIndicator(t.id,t.show)}},{key:"move",value:function(t){this.chartDm.moves(t),this.draw()}},{key:"zoom",value:function(t){var e=this.chartDm.barWidth;this.chartDm.barWidth-=t,e!==this.chartDm.barWidth&&this.draw()}},{key:"drawXAxis",value:function(){this.xScale.domain([this.chartDm.left_id,this.chartDm.right_id]),this.xScale.rangeRound([0,this.chartDm.barNumbers*this.chartDm.barWidth-this.chartDm.barWidth]),this.rootG.selectAll("g.x.axis").attr("transform","translate("+this.chartDm.barWidth/2+","+(this.innerHeight+.5)+")");var t=this.chartDm.klines;this.xAxis.tickFormat(function(e,i){return console.log(e,i),t[e]&&t[e].datetime?mi(t[e].datetime/1e6):""}),this.rootG.selectAll("g.x.axis").call(this.xAxis)}},{key:"draw",value:function(){if(console.log("draw",this.chartDm.left_id,this.chartDm.right_id),-1===this.chartDm.left_id||-1===this.chartDm.right_id)return!1;for(var t in this.loading.show&&(this.loading.show=!1),this.drawXAxis(),this.mainPlot.draw(),this.subPlots)this.subPlots[t].draw()}},{key:"width",get:function(){return this.outerWidth},set:function(e){if(!(e<this.margin.left+this.margin.right+t.INNER_WIDTH_MIN)){for(var i in this.outerWidth=e,this.innerWidth=this.outerWidth-this.margin.left-this.margin.right,this.svg.attr("width",this.outerWidth),this.chartDm.width=this.innerWidth,this.plotsManager.width=this.innerWidth,this.mainPlot.width=this.plotsManager.positions[0].width,this.subPlots)this.subPlots[i].width=this.plotsManager.positions[1].width;this.crosshair.width=this.innerWidth}}},{key:"height",get:function(){return this.outerHeight},set:function(e){if(!(e<this.margin.top+this.margin.bottom+t.INNER_HEIGHT_MIN)){for(var i in this.outerHeight=e,this.innerHeight=this.outerHeight-this.margin.top-this.margin.bottom,this.svg.attr("height",this.outerHeight),this.plotsManager.height=this.innerHeight,this.mainPlot.height=this.plotsManager.positions[0].height,this.mainPlot.top=this.plotsManager.positions[0].top,this.subPlots)this.subPlots[i].height=this.plotsManager.positions[1].height,this.subPlots[i].top=this.plotsManager.positions[1].top;this.crosshair.height=this.innerHeight}}},{key:"symbol",set:function(t){this.chartDm.symbol=t,setTimeout(this.draw.bind(this),0)},get:function(){return this._symbol}},{key:"duration",set:function(t){this.chartDm.duration=t,setTimeout(this.draw.bind(this),0)},get:function(){return this._duration}}]),t}();Object(de["a"])(gi,"ZOOM_SENSITIVITY",3),Object(de["a"])(gi,"INNER_HEIGHT_MIN",50),Object(de["a"])(gi,"INNER_WIDTH_MIN",80);var vi=gi,bi={"5s":5,"10s":10,"30s":30,"1m":60,"5m":300,"15m":900,"30m":1800,"1H":3600,"1D":86400},yi={name:"Chart",components:{},data:function(){return{width:this.$root.windowWidth,periods:Object.keys(bi),selectedPeriod:"1m",indicators:{ma3:{id:"ma3",name:"ma",params:3,show:!0},ma10:{id:"ma10",name:"ma",params:10,show:!0},ma30:{id:"ma30",name:"ma",params:30,show:!0},boll:{id:"boll",name:"boll",params:{n:3,p:5},show:!0}}}},computed:{duration:function(){return 1e9*bi[this.selectedPeriod]}},props:{instrumentId:{type:String,required:!0,default:"KQ.m@CFFEX.IF"},height:{type:Number,required:!0,default:400}},methods:{onchange:function(t){this.chart.showIndicator(this.indicators[t])},onKeyUp:function(t){console.log("onKeyUp",t)}},watch:{instrumentId:{handler:function(t,e){this.$tqsdk.subscribe_quote([this.instrumentId]),this.chart&&(this.chart.symbol=t)},immediate:!0},duration:{handler:function(t,e){this.chart&&(this.chart.duration=t)},immediate:!0},height:{handler:function(t,e){this.chart&&(this.chart.height=this.$refs.CHART.clientHeight,this.chart.draw())},immediate:!0}},activated:function(){console.log("activated")},deactivated:function(){console.log("deactivated")},mounted:function(){this.$on("global:resize",function(){this.chart.height=this.$refs.CHART.clientHeight,this.chart.width=this.$refs.CHART.clientWidth,this.chart.draw()}),this.$nextTick(function(){var t=this.$refs.CHART.clientHeight,e=this.$refs.CHART.clientWidth,i={top:20,right:50,bottom:20,left:50};for(var n in this.chart=new vi({id:"CHART",width:e,height:t,margin:i,dm:this.$tqsdk,ws:this.$tqsdk.quotesWs,instrumentId:this.instrumentId,duration:this.duration,mainPlotType:"candle"}),this.indicators)this.chart.addIndicator(this.indicators[n])})},destroyed:function(){console.log("destroyed")}},wi=yi,ki=(i("cd60"),Object(c["a"])(wi,oe,ce,!1,null,null,null));ki.options.__file="index.vue";var Ci=ki.exports,Si={components:{Chart:Ci},computed:{instrumentId:function(){return this.$route.params.instrument_id},height:function(){return this.$root.windowHeight*this.$root.appSplit}},created:function(){},mounted:function(){},methods:{goBack:function(){this.$router.go(-1)},onKeyUp:function(t){console.log("onKeyUp",t)}}},Ei=Si,xi=(i("12fe"),Object(c["a"])(Ei,se,ae,!1,null,"e7982402",null));xi.options.__file="Charts.vue";var Oi=xi.exports,Ti=[{id:"主连",func:function(t){return"FUTURE_CONT"===t.class}},{id:"指数",func:function(t){return"FUTURE_INDEX"===t.class}},{id:"金融",func:function(t){return["IH","IF","IC","T","TF"].includes(t.product_id)||["CFFEX.IH","CFFEX.IF","CFFEX.IC","CFFEX.T","CFFEX.TF"].includes(t.underlying_product)}},{id:"金银",func:function(t){return["au","ag"].includes(t.product_id)||["SHFE.au","SHFE.ag"].includes(t.underlying_product)}},{id:"铜铝铅锌",func:function(t){return["al","cu","ni","pb","sn","zn"].includes(t.product_id)||["SHFE.al","SHFE.cu","SHFE.ni","SHFE.pb","SHFE.sn","SHFE.zn"].includes(t.underlying_product)}},{id:"双焦",func:function(t){return["j","jm"].includes(t.product_id)||["DCE.j","DCE.jm"].includes(t.underlying_product)}},{id:"钢铁",func:function(t){return["SF","SM","hc","i","rb"].includes(t.product_id)||["CZCE.SF","CZCE.SM","SHFE.hc","DCE.i","SHFE.rb"].includes(t.underlying_product)}},{id:"煤炭",func:function(t){return["ZC","j","jm"].includes(t.product_id)||["CZCE.ZC","DCE.j","DCE.jm"].includes(t.underlying_product)}},{id:"化工",func:function(t){return["MA","TA","bu","l","pp","ru","v"].includes(t.product_id)||["CZCE.MA","CZCE.TA","SHFE.bu","DCE.l","DCE.pp","SHFE.ru","DCE.v"].includes(t.underlying_product)}},{id:"油脂",func:function(t){return["OI","p","y"].includes(t.product_id)||["CZCE.OI","DCE.p","DCE.y"].includes(t.underlying_product)}},{id:"软商品",func:function(t){return["CF","CY","SR"].includes(t.product_id)||["CZCE.CF","CZCE.CY","CZCE.SR"].includes(t.underlying_product)}},{id:"谷物",func:function(t){return["JR","LR","RI","WH","a","c"].includes(t.product_id)||["CZCE.JR","CZCE.LR","CZCE.RI","CZCE.WH","DCE.a","DCE.c"].includes(t.underlying_product)}},{id:"农副",func:function(t){return["cs","jd"].includes(t.product_id)||["DCE.cs","DCE.jd"].includes(t.underlying_product)}},{id:"饲料",func:function(t){return["RM","c","m"].includes(t.product_id)||["CZCE.RM","DCE.c","DCE.m"].includes(t.underlying_product)}},{id:"建材",func:function(t){return["FG","rb"].includes(t.product_id)||["CZCE.FG","SHFE.rb"].includes(t.underlying_product)}}],Di={};for(var ji in Ti)Di[Ti[ji].id]=[];var qi=Ti;n["default"].use(u["a"]);var Ii=new u["a"]({routes:[{path:"/quotes/:tag",name:"quotes",components:{quotes:lt,user:re}},{path:"/charts/:instrument_id",name:"charts",components:{quotes:Oi,user:re}},{path:"/*",redirect:"/quotes/"+qi[0].id}]}),Pi=(i("55dd"),{SET_BROKERS:function(t,e){t.brokers=e},SET_TAGS_QOUTES_MAP:function(t,e){var i={};for(var n in e){var r=e[n];if(!r.expired)for(var s in qi){var a=qi[s];a.func(r)&&(i[a.id]?i[a.id].push(n):i[a.id]=[n])}}for(var o in i)i[o].sort(function(t,i){var n=e[t].sort_key-e[i].sort_key;return 0===n?e[t].ins_id-e[i].ins_id:n});t.tagsQuotesMap=i},SET_LOGIN:function(t,e){t.logined=e},SET_SETTLEMENT:function(t,e){t.confirm="doing",t.confirmContent=e["content"]},SET_WS_CONNECT_STATUS:function(t,e){Object.assign(t,e)},SET_SELECTED_SYMBOL:function(t,e){t.selectSymbol=e},SET_SELECTED_SHOW_SYMBOL:function(t,e){t.selectShowSymbol=e}}),$i={getSelectedInstrumentId:function(t,e){return t.selectSymbol},getSelectedShowInstrumentId:function(t,e){return t.selectShowSymbol}};n["default"].use(m["a"]);var Mi=new m["a"].Store({state:{bid:"",user_id:"",logined:!1,confirm:"done",confirmContent:"",selectShowSymbol:"KQ.m@CFFEX.IF",selectSymbol:"",quoteWsConnected:!1,tradeWsConnected:!1,ins_list:[],tags:qi.map(function(t){return t.id}),tagsQuotesMap:Di},mutations:Pi,getters:$i}),Ni=Mi,Ai=i("e069"),Ri=i.n(Ai);i("dcad");n["default"].use(Ri.a,{transfer:!0,size:"small"}),Ie.on("ready",function(){Ni.commit("SET_TAGS_QOUTES_MAP",Ie.quotesInfo)}),Ie.on("error",function(){n["default"].prototype.$Message.error("获取合约列表失败，请检查网络后刷新页面。")}),n["default"].config.productionTip=!1,n["default"].config.errorHandler=function(t,e,i){console.error(t,e,i)},n["default"].filter("toPercent",function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,i=Number(t);return Number.isFinite(i)?i.toFixed(e):t});var Li={name:"tianqin-web",windowHeight:window.innerHeight,windowWidth:window.innerWidth,appSplit:.6},Fi=new n["default"]({data:Li,router:Ii,store:Ni,render:function(t){return t(h)},methods:{handlerResize:function(){Li.windowHeight=window.innerHeight,Li.windowWidth=window.innerWidth,this.$emit("global:resize")}},created:function(){var t;function e(){t||(t=setTimeout(function(){t=null,Fi.handlerResize()},66))}window.addEventListener("resize",e,!1)}}).$mount("#app")},"5c0b":function(t,e,i){"use strict";var n=i("5e27"),r=i.n(n);r.a},"5e27":function(t,e,i){},"6ee0":function(t,e,i){},"733b":function(t,e,i){"use strict";var n=i("870e"),r=i.n(n);r.a},8669:function(t,e,i){},"870e":function(t,e,i){},"88cf":function(t,e,i){"use strict";var n=i("de37"),r=i.n(n);r.a},"966f":function(t,e,i){"use strict";var n=i("a436"),r=i.n(n);r.a},a436:function(t,e,i){},ab6f:function(t,e,i){"use strict";var n=i("491c"),r=i.n(n);r.a},b152:function(t,e,i){},b947:function(t,e,i){"use strict";var n=i("b152"),r=i.n(n);r.a},cd60:function(t,e,i){"use strict";var n=i("f193"),r=i.n(n);r.a},cf60:function(t,e,i){},de37:function(t,e,i){},e86d:function(t,e,i){"use strict";var n=i("8669"),r=i.n(n);r.a},f193:function(t,e,i){}});